{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Video Recorder Configuration",
    "type": "object",
    "properties": {
        "configuration_files": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "description": "List of additional configuration files to load and merge. Paths are resolved relative to the current config file's directory, with fallback to the master config file's directory."
        },
        "data_directory": {
            "type": "string",
            "description": "Directory where recorded videos will be saved"
        },
        "record_audio": {
            "type": "boolean",
            "description": "Whether to record audio from the default microphone by default. Merged via logical OR across configuration files.",
            "default": false
        },
        "ros_topics": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "description": "List of ROS topics to be recorded in the bag file"
        },
        "stages": {
            "type": "array",
            "items": {
                "type": "string"
            },
            "description": "Optional list of stages to sequence recordings"
        },
        "videos": {
            "type": "array",
            "items": {
                "type": "object",
                "required": [
                    "name",
                    "stream"
                ],
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Name of the video stream"
                    },
                    "stream": {
                        "type": "string",
                        "description": "GStreamer source description string"
                    },
                    "record": {
                        "type": "boolean",
                        "description": "Whether to record this stream by default",
                        "default": true
                    },
                    "time_watermark": {
                        "type": "boolean",
                        "description": "Whether to burn GStreamer timestamps into the video by default",
                        "default": false
                    },
                    "encoding": {
                        "type": "object",
                        "properties": {
                            "bitrate": {
                                "type": "integer",
                                "description": "Bitrate in bits per second (optional)",
                                "default": 10000
                            },
                            "speed_preset": {
                                "type": "integer",
                                "description": "x264 speed preset (1-10) (optional). Lower is faster encoding, lower quality.",
                                "default": 5
                            },
                            "key_int_max": {
                                "type": "integer",
                                "description": "Maximum keyframe interval (optional)",
                                "default": 20
                            },
                            "frame_rate": {
                                "type": "integer",
                                "description": "Target frame rate for recording (optional)"
                            },
                            "width": {
                                "type": "integer",
                                "description": "Target width for recording (optional)"
                            },
                            "height": {
                                "type": "integer",
                                "description": "Target height for recording (optional)"
                            }
                        }
                    }
                }
            }
        }
    },
    "required": [
        "videos"
    ]
}